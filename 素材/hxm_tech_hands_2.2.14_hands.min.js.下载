!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hands=t():e.Hands=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="/7QA")}({"/7QA":function(e,t,n){"use strict";n.r(t);var r=n("cDf5"),i=n.n(r),o=n("TCgp");n.d(t,"Browser",(function(){return o.Browser}));var a=n("L8Ib"),s=function(e){var t=a.win[a.key]=new o.Browser(e),n=t._conf;return n&&!n.useFmp&&t.sendPerformance(),a.win[a.initFlag]=!0,t};o.Browser.singleton=function(e){return a.win[a.initFlag]?a.win[a.key]:s(e)},o.Browser.createExtraInstance=function(e){if(!a.win[a.key]){if("sample"in e&&0==e.sample)return void console.warn("[HANDS] sample 0");var t=a.win[a.key]=new o.Browser(e);e&&!e.useFmp&&t.sendPerformance(),a.win[a.initFlag]=!0}},"object"===("undefined"==typeof window?"undefined":i()(window))&&!!a.win.navigator&&!a.win.ActiveXObject&&(a.win[a.key]?function(){if(a.win[a.initFlag])return a.win[a.key];var e={};a.key in a.win&&(e=a.win[a.key].config||{}),e.serviceCode&&s(e)}():a.win.HandsLogger=o.Browser)},"/7sA":function(e,t,n){"use strict";n.r(t),n.d(t,"Base",(function(){return v}));var r=n("cDf5"),i=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),u=n("lSNA"),f=n.n(u),d=n("L8Ib"),h=n("M3MN"),l=n("GN+H");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=function(){function e(t){a()(this,e),f()(this,"ver",void 0),f()(this,"_conf",void 0),f()(this,"reportQueue",[]),f()(this,"errorQueue",[]),f()(this,"selfQueue",[]),f()(this,"sdkFlag",!0),f()(this,"pageview",void 0),f()(this,"traceId",void 0),f()(this,"reportHandler",void 0),f()(this,"reportErrorHandler",void 0),f()(this,"selfTimer",null),f()(this,"dftCon",d.dftCon),f()(this,"username",""),f()(this,"userId",""),f()(this,"deviceId",""),f()(this,"lastSendRootSid",""),f()(this,"sampleCache",{}),this.ver="2.2.14",this._conf=g({},this.dftCon),this.resetPageview(),this._conf=this.setConfig(t),this.traceId=this.getTraceId()}return c()(e,[{key:"_debug",value:function(){if(console&&this.getConfig("debug")){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o,a=t[0],s=(new Date).toJSON();if(t.shift(),1===t.length)if("object"===i()(t[0]))console.log("["+s+" "+a+"] ",JSON.stringify(t[0],null,2));else(r=console).log.apply(r,["["+s+" "+a+"] "].concat(t));else(o=console).log.apply(o,["["+s+" "+a+"] "].concat(t))}}},{key:"onReady",value:function(e){return this._debug("Base::onReady"),e()}},{key:"getPage",value:function(e){this._debug("Base::getPage",e);var t=this._conf.page;return Object(l.safetyCall)(t,[],t+"")}},{key:"setPage",value:function(e){this._debug("Base::setPage"),Object(l.warn)("will overridden by other",e)}},{key:"setConfig",value:function(e){if(this._debug("Base::setConfig",e),e&&"object"===i()(e)){Object(l.verifyConfig)(e);var t=this.setReportUrl(e);return this._conf=Object.assign({},this._conf,t),this._conf}}},{key:"setReportUrl",value:function(e){this._debug("Base::setReportUrl");var t=e.environment||"prod";return e.reportUrl=d.envMap[t]||d.defaultReportUrl,e}},{key:"checkReportUrl",value:function(e){this._debug("Base::checkReportUrl");var t=Object.values(d.envMap).includes(e);return t||Object(l.warn)("上报地址有误",e),t}},{key:"sendRequest",value:function(e,t){this._debug("Base::sendRequest"),Object(l.warn)("will overridden by other",e,t)}},{key:"resetPageview",value:function(){this.pageview=Object(l.seq)(),this.traceId=null}},{key:"getUsername",value:function(){if(!this.username){var e=this._conf&&this._conf.setUsername;if("function"==typeof e)try{var t=e();"string"==typeof t&&(this.username=t,this._debug("Base::getUsername",this.username))}catch(e){Object(l.warn)("设置用户名出错",e)}else this.username=Object(l.cookie)("yx_username")||Object(l.cookie)("yx_name")}return this._debug("Base::getUsername",this.username),this.username}},{key:"getUserId",value:function(){if(!this.userId){var e=this._conf&&this._conf.setUserId;if("function"==typeof e)try{var t=e();"string"==typeof t&&(this.userId=t,this._debug("Base::getUserId",this.userId))}catch(e){Object(l.warn)("设置用户ID出错",e)}else this.userId=Object(l.cookie)("yx_userid")||Object(l.cookie)("yx_username")}return this._debug("Base::getUserId",this.userId),this.userId}},{key:"getDeviceId",value:function(){if(!this.deviceId){var e=this._conf&&this._conf.setDeviceId;if("function"==typeof e)try{var t=e();"string"==typeof t&&(this.deviceId=t,this._debug("Base::DeviceId",this.deviceId))}catch(e){Object(l.warn)("设置设备ID出错",e)}else this.deviceId=Object(l.cookie)("yx_s_device")||""}return this._debug("Base::DeviceId",this.deviceId),this.deviceId}},{key:"getMetaInfo",value:function(){var e=this.getUserId(),t=this.getPage(),n=this.getConfig("serviceCode"),r=this.getTraceId(),i=this.getConfig("type"),o={app:n,uid:e,tid:r,page:Object(l.removeUrlSearch)(t),os:Object(l.getOs)(),bws:Object(l.getBrowser)(),sdk:this.ver,type:d.spanTypeMap[i]};return d.win&&(o.dpi="".concat(d.win.screen.width,"x").concat(d.win.screen.height)),o}},{key:"getTraceId",value:function(){if(this._conf&&this._conf.serviceCode){if(!this.traceId){var e=Object(l.uu)().slice(-8);this.traceId=Array.from([d.traceIdVersion,this._conf.serviceCode,Date.now(),e]).join("#")}this._debug("Base::getTraceId",this.traceId)}return this.traceId}},{key:"getSpanId",value:function(){var e=Object(l.seq)();return this._debug("Base::getSpanId",e),e}},{key:"getConfig",value:function(e){return e?this._conf&&this._conf[e]||null:Object.create(this._conf)}},{key:"sampling",value:function(e){return this._debug("Base::sampling",e),1===e||100===e||("boolean"!=typeof this.sampleCache[e]&&(this.sampleCache[e]=Object(l.pick)(e)),this.sampleCache[e])}},{key:"consuming",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._debug("Base::consuming",e.length),t?(clearTimeout(this.reportErrorHandler),this.reportErrorHandler=void 0,e&&e.length>0&&this.sendRequest(e,"/logs")):(clearTimeout(this.reportHandler),this.reportHandler=void 0,e&&e.length>0&&this.sendRequest(e))}},{key:"clearSelf",value:function(){this._debug("Base::clearSelf"),clearTimeout(this.selfTimer),this.selfTimer=null;var e=this.getMetaInfo();return Object(h.sender)(this.selfQueue,this.getConfig("reportUrl"),e).catch(l.noop),this.selfQueue=[],this}},{key:"pushToBatchQueue",value:function(e){var t=this;this._debug("Base::pushToBatchQueue",e),e.sid?this.reportQueue&&this.reportQueue.length>0&&this.reportQueue.some((function(t){return t.sid===e.sid}))?this._debug("Base::pushToBatchQueue::sameSid",e&&e.sid):(this.reportQueue.unshift(e),this.onReady((function(){t.reportHandler||(t.reportHandler=Object(l.delay)((function(){if(t.reportQueue.length>0){var e=t.reportQueue.length;t.consuming(t.reportQueue),t.reportQueue.splice(t.reportQueue.length-e,e)}}),3e3))}))):this._debug("Base::pushToBatchQueue::noSid",e&&e.sid)}},{key:"pushToErrorQueue",value:function(e){var t=this;this._debug("Base::pushToErrorQueue",e);var n=this.errorQueue[0];if(n&&n.msg===e.msg)n.times++;else{if(this.errorQueue.unshift(e),this.reportErrorHandler)return;this.reportErrorHandler=Object(l.delay)((function(){var e=t.errorQueue.length;t.errorQueue.length>0&&(t.consuming(t.errorQueue,!0),t.errorQueue.splice(t.errorQueue.length-e,e))}),3e3)}}},{key:"report",value:function(e,t,n){this._debug("Base::report",t);var r=this.getPage(),i=this._conf.ignore;return!Object(l.ignoreByRule)(r,i&&i.ignoreUrls)&&!Object(l.ignoreByRule)(Object(l.decode)(r),i&&i.ignoreUrls)&&(("ajax"!==e||!Object(l.ignoreByRule)(t.api,i&&i.ignoreApis)&&!Object(l.ignoreByRule)(Object(l.decode)(t.api),i&&i.ignoreApis))&&(!(!t||this._conf.disabled||!this._conf.serviceCode)&&(this.sampling(n)?(this._debug("Base::report::sample::true"),"pageroot"===e?this.lastSendRootSid!==t.sid&&(this.lastSendRootSid=t.sid,this.sendRequest([t])):this.pushToBatchQueue(t)):(this._debug("Base::report::sample::false"),!1))))}},{key:"self",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this._debug("Base::self",e,t,r),"error"!==e)return this;if(!this.checkReportUrl(this._conf.reportUrl))return this;if(!t||this._conf.disabled||!this._conf.pid||!d.cryptoId)return this;if(r&&!this.sampling(r))return this;var i=g(g({type:e,times:1,page:d.selfErrPage,begin:Date.now()},t),{},{version:this.ver,sample:r||1}),o=this.selfQueue[0];if(o){o.times++;try{var a=o.err&&o.err.msg_raw,s=i.err&&i.err.msg_raw;a&&s&&a.split("&").indexOf(s)<0&&a.length<1e3&&(o.err.msg_raw+="&"+s)}catch(e){}}else this.selfQueue.unshift(i),this.onReady((function(){n.sdkFlag&&(n.sdkFlag=!1,n.selfTimer=Object(l.delay)((function(){return n.clearSelf()}),1e4))}));return this}}]),e}()},"0HV0":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n("Qp8T"),i=window.performance?performance.timing:null,o=r.default.states;function a(e){if(e)return o.create().then((function(e){return Promise.resolve(e.ready)}));var t=o.currentState;return t.instance?new Promise((function(e,n){t.finished?e(t.timing.ready):t.failed?n(t.failed):t.instance.promise.then((function(t){e(t.ready)}),(function(e){n(e)}))})):function e(){return new Promise((function(t,n){if(i||n("Object performance not supported"),i.domContentLoadedEventEnd){var r=i.domContentLoadedEventEnd-i.fetchStart;o.initialState.timing.ready=r,t(r)}else setTimeout((function(){t(e())}),500)}))}()}},"4N3c":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n("Qp8T").default.states;function i(){return new Promise((function(e,t){var n=r.currentState;n.instance||(n=r.initialState),n.finished?e(n.instance.resources):n.failed?t(n.failed):n.instance.promise.then((function(t){e(n.instance.resources)}),(function(e){t(e)}))}))}},"7W2i":function(e,t,n){var r=n("SksO");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},AGrN:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n("Qp8T"),i=window.performance?performance.timing:null,o=r.default.states;function a(e){if(e)return o.create().then((function(e){return Promise.resolve(e.load)}));var t=o.currentState;return t.instance?new Promise((function(e,n){t.finished?e(t.timing.load):t.failed?n(t.failed):t.instance.promise.then((function(t){e(t.load)}),(function(e){n(e)}))})):function e(){return new Promise((function(t,n){if(i||n("Object performance not supported"),i.loadEventEnd){var r=i.loadEventEnd-i.fetchStart;o.initialState.timing.load=r,t(r)}else setTimeout((function(){t(e())}),500)}))}()}},Dcxn:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n("Qp8T").default.states;function i(e){return e?r.create().then((function(e){return Promise.resolve(e.fmp)})):new Promise((function(e,t){var n=r.currentState;n.instance||(n=r.initialState),n.finished?e(n.timing.fmp):n.failed?t(n.failed):n.instance.promise.then((function(t){e(t.fmp)}),(function(e){t(e)}))}))}},"GN+H":function(e,t,n){"use strict";n.r(t),n.d(t,"noop",(function(){return c})),n.d(t,"warn",(function(){return u})),n.d(t,"ext",(function(){return f})),n.d(t,"each",(function(){return d})),n.d(t,"safetyCall",(function(){return h})),n.d(t,"typeTest",(function(){return l})),n.d(t,"filterByRule",(function(){return p})),n.d(t,"ignoreByRule",(function(){return g})),n.d(t,"jsonParse",(function(){return v})),n.d(t,"pick",(function(){return m})),n.d(t,"verifyConfig",(function(){return y})),n.d(t,"on",(function(){return b})),n.d(t,"off",(function(){return w})),n.d(t,"delay",(function(){return O})),n.d(t,"sub",(function(){return j})),n.d(t,"uu",(function(){return k})),n.d(t,"seq",(function(){return _})),n.d(t,"decode",(function(){return S})),n.d(t,"encode",(function(){return H})),n.d(t,"encodeJson",(function(){return E})),n.d(t,"jsonify",(function(){return T})),n.d(t,"serialize",(function(){return I})),n.d(t,"checkAPI",(function(){return P})),n.d(t,"ignoreDevInfo",(function(){return R})),n.d(t,"checkAutoError",(function(){return B})),n.d(t,"cutUrlSearch",(function(){return C})),n.d(t,"removeUrlSearch",(function(){return x})),n.d(t,"createFakeToString",(function(){return M})),n.d(t,"checkSameOrigin",(function(){return A})),n.d(t,"getCurrentDomain",(function(){return D})),n.d(t,"getCurrentOrigin",(function(){return N})),n.d(t,"parseFetchHeaders",(function(){return L})),n.d(t,"parseXhrHeaders",(function(){return U})),n.d(t,"getQuerys",(function(){return Q})),n.d(t,"getFetchSnapshot",(function(){return F})),n.d(t,"getXhrSnapshot",(function(){return X})),n.d(t,"isRobot",(function(){return q})),n.d(t,"getStartTime",(function(){return J})),n.d(t,"reWriteMethod",(function(){return G})),n.d(t,"checkSDKError",(function(){return K})),n.d(t,"cookie",(function(){return V})),n.d(t,"getOs",(function(){return $})),n.d(t,"getBrowser",(function(){return Y})),n.d(t,"getPlatform",(function(){return z})),n.d(t,"getChannel",(function(){return Z})),n.d(t,"go",(function(){return ee}));var r=n("cDf5"),i=n.n(r),o=n("L8Ib"),a=n("dI0T"),s=Date.now(),c=function(){},u=function(e){var t="object"===("undefined"==typeof console?"undefined":i()(console))?console.warn:c;try{for(var n={warn:t},r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];o&&o.length>0?n.warn("[HANDS] "+e,o):n.warn("[HANDS] "+e)}catch(e){return c()}},f=function(e){for(var t=0,n=arguments.length<=1?0:arguments.length-1;t<n;t++){var r=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},d=function(e,t){if(l(e,"array"))for(var n=0;n<e.length&&!1!==t.call(e[n],e[n],n);n++);else for(var r in e)if(e.hasOwnProperty(r)&&!1===t.call(e[r],e[r],r))break;return e},h=function(e,t,n){if(!l(e,"function"))return n;try{return e.apply(void 0,t)}catch(e){return n}},l=function(e,t){var n=Object.prototype.toString.call(e).substring(8).replace("]","").toLowerCase();return t?n===t.toLowerCase():n},p=function e(t,n){return t?n?l(n,"Function")?h(n,[t],t):l(n,"Array")?(d(n,(function(n){t=e(t,n)})),t):(l(n,"Object")?(l(n.rule,"string")?r=new RegExp(n.rule,"g"):l(n.rule,"regexp")&&(r=n.rule),t.replace(r,n.target||"")):(l(n,"string")?i=new RegExp(n,"g"):l(n,"regexp")&&(i=n),t.replace(i,"")),t):t:"";var r,i},g=function(e,t){if(!e||!t)return!1;if((l(t,"string")||t.source||l(t,"function"))&&(t=[t]),!l(t,"array"))return!1;for(var n,r=[],i=0;i<t.length;i++)if(n=t[i],l(n,"string"))r.push(n.replace(o.DangerStringReg,"\\$1"));else if(n&&n.source)r.push(n.source);else if(n&&l(n,"function")&&!0===h(n,[e],!1))return!0;var a=new RegExp(r.join("|"),"i");return!!(r.length&&a.test&&a.test(e))},v=function(e){if(!e||"string"!=typeof e)return e;var t=null;try{t=JSON.parse(e)}catch(e){return null}return t},m=function(e){return 1===e||1===Math.ceil(Math.random()*(100/e))},y=function(e){if("sample"in e){var t=e.sample,n=t;t&&o.PercentReg.test(t)&&(n=parseInt(String(100/parseFloat(t)))),n>0&&n<1&&(n=parseInt(String(1/n))),n>=1&&n<=100?e.sample=n:delete e.sample}return e},b=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return e.addEventListener?e.addEventListener(t,(function o(a){r&&e.removeEventListener(t,o,i),n.call(e,a)}),i):e.attachEvent&&e.attachEvent("on"+t,(function i(o){r&&e.detachEvent("on"+t,i),n.call(e,o)})),this},w=function(e,t,n){return n&&(e.removeEventListener?e.removeEventListener(t,n):e.detachEvent&&e.detachEvent("on"+t,n)),this},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(-1===t)return e(),null;setTimeout(e,t)},j=function(e,t){var n={};return d(e,(function(e,r){-1!==t.indexOf(r)&&(n[r]=e)})),n},k=function(){for(var e,t,n=new Array(20),r=Date.now().toString(36).split(""),i=20;i>0;i--)t=(e=36*Math.random()|0).toString(36),n[i]=e%3?t:t.toUpperCase();for(var o=0;o<8;o++)n.splice(3*o+2,0,r[o]);return n.join("")},_=function(){return(++s).toString().slice(-8)},S=function(e){try{e=decodeURIComponent(e)}catch(e){}return e},H=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{e=t?encodeURIComponent(e).replace(/\(/g,"%28").replace(/\)/g,"%29"):encodeURIComponent(e)}catch(e){}return e},E=function(e){var t;try{t="function"==typeof encodeURIComponent&&JSON&&encodeURIComponent(JSON.stringify(e))||"{}"}catch(e){t="{}"}return t},T=function(e){var t;try{t=JSON.stringify(e)}catch(e){t="{}"}return t},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=[];for(var r in e)e.hasOwnProperty(r)&&void 0!==e[r]&&n.push(r+"="+H(e[r],"msg"===r));return(t?"?":"")+n.join("&")},P=function(e,t){if(!e||"string"!=typeof e)return!1;var n=/[\W]*\.you\.163\.com/.test(e);return!n&&t&&(n=/(nosdn\.127\.net)|(nos\.netease\.com)/.test(e)),!n},R=function(e,t){return t.test(e)},B=function(e){return e&&e.message&&!/failed[\w\s]+fetch/i.test(e.message)},C=function(e){return e&&"string"==typeof e?e.replace(/^(https?:)?\/\//,"").replace(/(\?|;).*$/,""):""},x=function(e){return e&&"string"==typeof e?e.replace(/(\?|;).*$/,""):""},M=function(e){return function(){return e+"() { [native code] }"}},A=function(e,t){if(!e||!t)return!1;var n="//"+t.split("/")[2];return e===t||e.slice(0,t.length+1)===t+"/"||e===n||e.slice(0,n.length+1)===n+"/"||!o.protocolReg.test(e)},D=function(){return location&&location.hostname||""},N=function(){var e="";try{e=location&&location.origin?location.origin:location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}catch(e){}return e},L=function(e){if(!e)return{};var t={};try{if(l(e.keys,"function"))for(var n=e.keys(),r=n.next();!r.done;){var i=r.value;t[i]=e.get(i),r=n.next()}else t=e}catch(e){t={}}return t},U=function(e){if(!e&&"string"!=typeof e)return{};var t;try{t=e.split("\r\n").reduce((function(e,t){var n=t.split(": ");return e[n[0]]=n[1],e}),{})}catch(e){t={}}return t},Q=function(e){if(!e)return{};var t,n,r={},i=[];try{if(e.indexOf("?")>=0&&(i=e.substring(e.indexOf("?")+1,e.length).split("&")),i.length>0)for(var o in i){var a=i[o].split("=");t=a[0],n=a[1],r[t]=n}}catch(e){r={}}return r},F=function(e,t,n){var r,i;try{var o=(e&&"string"!=typeof e[0]?e[0].url:e[0])||"",a=(e&&"string"!=typeof e[0]?e[0]:e[1])||{},s=a.method&&"POST"===a.method.toUpperCase()?a.body:Q(o);r={originApi:o,method:a.method||"unknown",params:s,response:t||"",reqHeaders:L(a.headers||null),resHeaders:L(n)},i=T(r)}catch(e){u("获取fetch snapshot错误",e),i="{}"}return i},X=function(e,t,n){if(!e||!t||!n)return"{}";var r;try{var i="";""===n.responseType||"text"===n.responseType?i=n.responseText:"document"!==n.responseType||(i=n.responseXML.toString());var o={originApi:e,method:t,params:Q(e),response:i,reqHeaders:{},resHeaders:U("function"==typeof n.getAllResponseHeaders&&n.getAllResponseHeaders()||"")};r=T(o)}catch(e){u("获取xhr snapshot错误",e),r="{}"}return r},q=function(){if(!navigator||"string"!=typeof navigator.userAgent)return!1;try{var e=navigator.userAgent.toLowerCase();return o.commonRobotList.some((function(t){return e.lastIndexOf(t)>=0}))}catch(e){u("useragent parse error")}return!1},J=function(){var e;try{var t=performance.timing.fetchStart;e="object"===("undefined"==typeof performance?"undefined":i()(performance))?t:Date.now()}catch(t){e=Date.now()}return e},G=function(e,t,n){if(null!==e){var r=e[t];e[t]=n(r)}},K=function(e,t){return!(!e&&!t)&&(!!new RegExp(o.selfErrKey,"i").test(e)||!!g(t,o.selfErrPaths))},W=Object.create(null),V=function(e,t,n,r,i){if(void 0===t){var a;if(!W[e]){var s=new RegExp(e+"=([^;]+)");try{o.win&&o.win.document&&(a=s.exec(o.win.document.cookie))}catch(e){return u("can not get cookie: ",e),null}a&&(W[e]=S(a[1]))}return W[e]}var c="".concat(e,"=").concat(t)+(r?"; domain=".concat(r):"")+"; path=".concat(i||"/")+(n?"; max-age=".concat(n||15552e3):"");try{return o.win.document.cookie=c,!!o.win.document.cookie}catch(e){return u("can not set cookie: ",e),!1}},$=function(){if(!o.win)return"mini";var e="navigator"in o.win&&"appVersion"in o.win.navigator&&o.win.navigator.appVersion.toLowerCase()||"";return/iphone/i.test(o.ua)||/ipad/i.test(o.ua)||/ipod/i.test(o.ua)?"iOS":/mac/i.test(e)?"MacOSX":/android/i.test(o.ua)?"Android":/win/i.test(e)&&/phone/i.test(o.ua)?"WindowsPhone":/win/i.test(e)?"Windows":/linux/i.test(e)?"Linux":"other"},Y=function(){if(!o.ua)return"mini";for(var e=[],t=[[/yanxuan\/([\d\.]+)/i,"Yanxuan",1],[/maxthon[\/ ]([\d\.]+)/i,"Maxthon",1],[/msie.*360se/i,"360SE",-1],[/msie.*360ee/i,"360EE",-1],[/se ([\d]+.[\w]*) metasr ([\d\.]+)/i,"Sogou",1],[/msie.*qihu theworld/i,"Theworld",-1],[/micromessenger\/([\d\.]+)/i,"MicroMessenger",1],[/tencenttraveler ([\d\.]+)/i,"TencentTraveler",1],[/qqbrowser\/([\d\.]+)/i,"QQBrowser",1],[/qq\/([\d\.]+)/i,"QQ",1],[/msie ([\d\.]+)/i,"IExplorer",1],[/firefox\/([\d\.]+)/i,"Firefox",1],[/opera.+version\/([\d\.]+)/i,"Opera",1],[/opr\/([\d\.]+)/i,"Opera",1],[/ucbrowser\/([\d\.]+)/i,"UCBrowser",1],[/baiduboxapp\/([\d\.]+)/i,"BaiduBoxApp",1],[/baidubrowser\/([\d\.]+)/i,"BaiduBrowser",1],[/miuibrowser\/([\d\.]+)/i,"MiuiBrowser",1],[/chrome\/([\d\.]+)/i,"Chrome",1],[/crios\/([\d\.]+)/i,"Chrome",1],[/version\/([\d\.]+).*safari/i,"Safari",1]],n=0;n<t.length;n++){var r=t[n],i=o.ua.match(r[0]);if(i){e.push(r[1]),-1==r[2]?e.push(""):"Yanxuan"===r[1]?e.push(i[1]):e.push(i[1].split(".")[0]);break}}return 0==e.length?"other":e.join("-")},z=function(){var e="";if(o.ua)if(o.ua.match(/MicroMessenger/i)){if(o.ua.match(/miniProgram/i))return"mini";e="wap"}else o.ua.match(/yanxuan/i)?o.ua.match(/Android/i)?e="app-android":o.ua.match(/iPhone/i)&&(e="app-ios"):e=o.ua.match(/NeteaseMusic/i)?o.ua.match(/Android/i)?"music-android":o.ua.match(/iPhone/i)?"music-ios":"music-other":o.ua.match(/mobile/i)?"wap":"pc";else e="mini";return e},Z=function(){if(!location&&!location.href)return"";var e=V("yx_appchannel_groupId");if(e)return e;var t=V("yx_channel_type"),n=Q(location.href).channel_type||t||"";if(n){var r=n.split("-");return Array.isArray(r)&&2===r.length?r[r.length-1]:""}return""},ee=function(e,t){return a(e,t)}},Jqko:function(e,t,n){"use strict";n.r(t),n.d(t,"getAll",(function(){return c}));var r=n("Dcxn");n.d(t,"getFmp",(function(){return r.default}));var i=n("0HV0");n.d(t,"getReady",(function(){return i.default}));var o=n("s34b");n.d(t,"getFpt",(function(){return o.default}));var a=n("AGrN");n.d(t,"getLoad",(function(){return a.default}));var s=n("4N3c");function c(e){return Promise.all([Object(o.default)(e),Object(r.default)(),Object(a.default)(),Object(i.default)()]).then((function(e){return Promise.resolve({fpt:e[0],fmp:e[1],load:e[2],ready:e[3]})}))}n.d(t,"getResources",(function(){return s.default})),t.default=c},L8Ib:function(e,t,n){"use strict";n.r(t),n.d(t,"dftCon",(function(){return a})),n.d(t,"TimeType",(function(){return r})),n.d(t,"spanTypeMap",(function(){return s})),n.d(t,"cryptoId",(function(){return c})),n.d(t,"key",(function(){return u})),n.d(t,"initFlag",(function(){return f})),n.d(t,"selfErrKey",(function(){return d})),n.d(t,"scriptErrorReg",(function(){return h})),n.d(t,"selfErrPage",(function(){return l})),n.d(t,"selfErrPaths",(function(){return p})),n.d(t,"envMap",(function(){return g})),n.d(t,"defaultReportUrl",(function(){return v})),n.d(t,"traceIdVersion",(function(){return m})),n.d(t,"validApiKeys",(function(){return y})),n.d(t,"ignoreTagList",(function(){return b})),n.d(t,"timingKeys",(function(){return w})),n.d(t,"htmlAttributes",(function(){return O})),n.d(t,"consoleMethods",(function(){return j})),n.d(t,"fetchMethod",(function(){return k})),n.d(t,"fetchMark",(function(){return _})),n.d(t,"xhrMethod",(function(){return S})),n.d(t,"xhrMark",(function(){return H})),n.d(t,"HandsHeaders",(function(){return E})),n.d(t,"PercentReg",(function(){return T})),n.d(t,"protocolReg",(function(){return I})),n.d(t,"ignoreConsole",(function(){return P})),n.d(t,"DangerStringReg",(function(){return R})),n.d(t,"commonRobotList",(function(){return B})),n.d(t,"win",(function(){return C})),n.d(t,"ua",(function(){return x}));var r,i=n("cDf5"),o=n.n(i),a={environment:"prod",ignore:{ignoreUrls:[],ignoreApis:[],ignoreErrors:[/^Script error\.?$/]},sample:1};!function(e){e[e.timestamp=1]="timestamp",e[e.duration=2]="duration"}(r||(r={}));var s={web:1980,h5:1981,miniapp:1982},c="b79a3c7775aeb30a8e4c2efe36eff8d3",u="__hands",f="__hasInitHandsSdk",d="HANDS_SDK_ERROR",h=/^Script error\.?$/,l="HANDSSDK",p=[/nos.netease.com\/mailpub-test\/hxm\/tech\/hands.min.js/,/nos.netease.com\/mailpub-test\/hxm\/tech\/wx.min.js/,/nos.netease.com\/mailpub-test\/hxm\/tech\/tt.min.js/,/nos.netease.com\/mailpub\/hxm\/tech\/hands.min.js/,/nos.netease.com\/mailpub\/hxm\/tech\/wx.min.js/,/nos.netease.com\/mailpub\/hxm\/tech\/tt.min.js/],g={test:"http://caesar-gateway.test.you.163.com/web",prod:"https://apm.you.163.com/web"},v="http://caesar-gateway.test.you.163.com/web",m="1",y=["api","success","time","code","msg","begin","apiSnapshot","method"],b=["SCRIPT","STYLE","META","HEAD","LINK"],w=["","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","","domInteractive","","domContentLoadedEventEnd","","loadEventStart","","msFirstPaint","secureConnectionStart"],O=["type","name","title","alt"],j=["debug","info","warn","log","error","assert"],k="fetch",_="__oFetch_",S="XMLHttpRequest",H="__oXMLHttpRequest_",E={traceId:"NTES-TRACEID",spanId:"NTES-SPANID",pending:"NTES-REQUEST-PENDING"},T=/^\d+(\.\d+)?%$/,I=/^(\/\/|http:|https:).*/,P=/HMR|Browser::|Base::|Reporter::/,R=/([.*+?^=!:${}()|\[\]\/\\])/g,B=["nuhk","googlebot/","googlebot-image","yammybot","openbot","slurp","msnbot","ask jeeves/teoma","ia_archiver","baiduspider","bingbot/","adsbot","yandex"],C="object"===("undefined"==typeof window?"undefined":o()(window))&&window.document?window:void 0,x=C&&C.navigator.userAgent},LjfM:function(e,t,n){"use strict";n.r(t),n.d(t,"performance",(function(){return o}));var r=n("GN+H"),i=n("L8Ib"),o=function(){var e=i.win.performance;if(!e||!Object(r.typeTest)(e,"performance")||!Object(r.typeTest)(e.getEntriesByType,"function"))return null;var t=Object.create(null),n=null,o=e.timing||{},a=Date.now(),s=i.TimeType.timestamp;Object(r.typeTest)(i.win.PerformanceNavigationTiming,"function")&&(n=e.getEntriesByType("navigation")[0])&&(o=n,s=i.TimeType.duration),Object(r.each)({dnsQuery:[3,2],tcpConnect:[5,4],contentTransfer:[8,7],domExplain:[10,8],resourceLoad:[14,12],responseTime:[7,6],firstPaint:[8,1],firstInteractive:[10,1],domReady:[12,1],completeLoad:[14,1],fmp:[14,1],firstPage:[15,1],ttfb:[7,1],fb:[7,2],ssl:[5,17]},(function(e,n){var r=o[i.timingKeys[e[1]]],a=o[i.timingKeys[e[0]]];if(s===i.TimeType.duration||r>0&&a>0){var c=Math.round(a-r);c>=0&&c<1e5&&(t[n]=c)}}));var c=i.win.navigator.connection,u=e.navigation||{};t.ct=c?c.effectiveType||c.type:"";var f=c&&(c.downlink||c.downlinkMax||c.bandwidth)||null;(f=f>999?999:f)&&(t.bandwidth=parseInt(f)),t.navtype=1===u.type?"reload":"other";var d=o[i.timingKeys[1]];return s===i.TimeType.timestamp&&d>0?t.begin=d:t.begin=s===i.TimeType.duration&&t.load>0?a-t.load:a,t}},M3MN:function(e,t,n){"use strict";n.r(t),n.d(t,"sender",(function(){return i}));var r=n("L8Ib"),i=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/spans";if(e&&0===e.length)return Promise.reject();if(!n)return Promise.reject();t+=i;var o=r.win&&r.win[r.fetchMark]||r.win.fetch,a="function"==typeof o?o:void 0;return a(t,{body:JSON.stringify({meta:n,list:e}),credentials:"include",mode:"no-cors",method:"POST"}).catch((function(e){return Promise.reject(e)}))}},Nsbk:function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},PJYZ:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},Qp8T:function(e,t,n){"use strict";n.r(t);var r=n("lwsE"),i=n.n(r),o=n("W8MJ"),a=n.n(o),s=performance&&performance.timing&&performance.timing.fetchStart,c=["SCRIPT","STYLE","META","HEAD","LINK"],u="__PT_FMP_DOM_INDEX__",f={SVG:2,IMG:2,CANVAS:4,OBJECT:4,EMBED:4,VIDEO:4},d=window.innerWidth,h=window.innerHeight,l={callbacks:{onTimingFinished:null,onTimingFailed:null},initialState:{finished:!1,failed:null,instance:null,timing:{fpt:null,ready:null,fmp:null,load:null}},currentState:{finished:!1,failed:null,instance:null,timing:{fpt:null,ready:null,fmp:null,load:null}},create:function(e,t){var n=this.currentState;return n.finished=!1,this.initialState.instance.destroyed||this.initialState.instance.destroy(),n.instance&&n.instance.destroy(),Object.assign(n.timing,{fpt:null,ready:null,fmp:null,load:null}),n.instance=e||new p(Date.now()),n.instance.promise.then((function(e){Object.assign(n.timing,e),n.finished=!0}),(function(e){n.failed=e})),n.instance.promise}},p=function(){function e(t){var n=this;i()(this,e),this.startTime=t||s,this.snapshots=[],this.finished=!1,this.muo=MutationObserver,this.observer=null,this.snapshotId=0,this.resourceLoadTime={},this.entriesCount=0,this.firstScreenElement=null,this.timing={fpt:null,ready:null,fmp:null,load:null},this.resources={fmpResources:null,allResources:null},this.promise=new Promise((function(e,t){n.resolve=function(){e.apply(this,arguments);var t=l.callbacks.onTimingFinished;"function"==typeof t&&t.call(this,arguments[0])},n.reject=function(){t.apply(this,arguments);var e=l.callbacks.onTimingFailed;"function"==typeof e&&e.call(this,arguments[0])}})),window.performance&&window.performance.timing&&window.performance.getEntries?this.initialize():this.reject("Object performance not supported")}return a()(e,null,[{key:"states",get:function(){return l}}]),a()(e,[{key:"capture",value:function(){if(!this.destroyed){var e,t=Date.now()-this.startTime,n=document.body,r=this.snapshotId;this.firstScreenElement?e=this.tag(this.firstScreenElement,r):n&&(e=this.tag(n,r)),e&&(this.snapshotId++,this.snapshots[r]={t:t})}}},{key:"initialize",value:function(){var e=this;this.capture(),this.onload().then((function(t){var n=e.timing;n.load=t,n.fpt=0,n.fmp||(n.fmp=t),n.ready||(n.ready=t),e.resolve(e.timing)})),this.observer=new MutationObserver(this.capture.bind(this)),this.observer.observe(document,{childList:!0,subtree:!0}),"complete"===document.readyState?this.finish():window.addEventListener("load",(function(){e.finish()}),!0)}},{key:"initResourceMap",value:function(){var e=this;performance.getEntries().forEach((function(t){t.startTime<e.startTime-s||(e.resourceLoadTime[t.name]=t.responseEnd?t.responseEnd-(e.startTime-s):t.duration+t.startTime-(e.startTime-s))}))}},{key:"tag",value:function(e,t){var n=e.tagName;if(-1!==c.indexOf(n))return!1;var r=e.children?e.children.length:0;if(0===r)return!1;for(var i=!1,o=e.children,a=r-1;a>=0;a--){var s=o[a];void 0===s[u]&&(s[u]=t,!this.firstScreenElement&&s.hasAttribute("performance-first-screen")&&(this.firstScreenElement=s),i=!0),!0===this.tag(s,t)&&(i=!0)}return i}},{key:"untag",value:function(e){var t=e.tagName;if(-1===c.indexOf(t)){var n=e.children?e.children.length:0;if(0!==n)for(var r=e.children,i=n-1;i>=0;i--)void 0!==r[i][u]&&delete r[i][u],this.untag(r[i])}}},{key:"finish",value:function(){var e=this;if(this.destroyed)this.reject("Getting timing aborted");else if(MutationObserver&&!this.finished){if(!this.calculable(this.startTime))return void setTimeout((function(){e.finish()}),500);this.observer.disconnect(),this.finished=!0;var t,n=this.timing,r=this.resources;if(n.ready=this.snapshots.length>0?this.snapshots[this.snapshots.length-1].t:0,this.deepTraversal(this.firstScreenElement||document.body).dpss.forEach((function(e){t&&t.st?t.st<e.st&&(t=e):t=e})),!t)return;this.initResourceMap();var i=this.filterTheResultSet(t.els);if(0===i.length)return;var o=this.calcaulateResult(i);if(!o)return;n.fmp=parseInt(o[0]),r.fmpResources=o[1],r.allResources=this.resourceLoadTime}}},{key:"onload",value:function(){var e=this;return new Promise((function(t,n){var r=performance.getEntries();if(r.length===e.entriesCount&&e.finished){var i=0;0===r.length?i=Date.now()-e.startTime:r.forEach((function(t){t.responseEnd>i&&(i=t.responseEnd-(e.startTime-s))})),(i=Math.round(i))<e.timing.ready&&(i=e.timing.ready),t(i)}else e.entriesCount=r.length,setTimeout((function(){t(e.onload())}),500)}))}},{key:"calcaulateResult",value:function(e){var t=this,n=0,r=[],i=0;return e.forEach((function(e){if(void 0!==e.node[u]){var o=0,a=parseInt(e.node[u]),s=t.snapshots[a].t,c=e.node,f=e.node.tagName,d={tag:f,className:c.className,id:c.id,snapshot:s,latest:!1},h=r.length;if(r.push(d),1===e.weight)o=s;else if(2===e.weight)if("IMG"===f)c.getAttribute("src")?(d.url=c.src,d.load=t.resourceLoadTime[c.src],o=d.load?Math.max(d.load,s):s):o=s;else if("SVG"===f)o=s;else{var l,p=g(c,"background-image").match(/url\(\"(.*?)\"\)/);p&&p[1]&&(l=p[1]),l&&l.match(/^(https?\:)?\/\//)?(l.match(/^http/)||(l=location.protocol+p[1]),-1==l.indexOf("http")&&(l=location.protocol+p[1]),d.url=l,d.load=t.resourceLoadTime[l],o=d.load?Math.max(d.load,s):s):o=s}else 4===e.weight&&("VIDEO"===f?(d.url=c.src||c.poster,d.load=t.resourceLoadTime[c.src]||t.resourceLoadTime[c.poster],o=d.load?Math.max(d.load,s):s):o=s);n<o&&(i=h,n=o)}})),r[i]&&(r[i].latest=!0),[n,r]}},{key:"filterTheResultSet",value:function(e){if(1===e.length)return e;var t=0;e.forEach((function(e){t+=e.st}));var n=t/e.length;return e.filter((function(e){return e.st>n}))}},{key:"deepTraversal",value:function(e){if(e){for(var t,n=[],r=0;t=e.children[r];r++){var i=this.deepTraversal(t);i.st&&n.push(i)}return this.calculateScore(e,n)}return{}}},{key:"isInFirstScreenElement",value:function(e){var t=this.firstScreenElement;return!!t&&(e===t||!!e.parentNode&&this.isInFirstScreenElement(e.parentNode))}},{key:"calculateScore",value:function(e,t){var n=e.getBoundingClientRect(),r=n.width,i=n.height,o=n.left,a=n.top,s=1;!this.isInFirstScreenElement(e)&&(h<a||d<o||a+i<=0||o+r<=0)&&(s=0);var c=0;t.forEach((function(e){c+=e.st}));var u=f[e.tagName]||1;1===u&&g(e,"background-image")&&"initial"!==g(e,"background-image")&&"none"!==g(e,"background-image")&&(u=f.IMG);var l=r*i*u*s,p=[{node:e,st:l,weight:u}],v=this.calculateAreaPercent(e);return(1===e.children.length&&1===u&&1===t.length||c>l*v||0===v)&&(l=c,p=[],t.forEach((function(e){p=p.concat(e.els)}))),{dpss:t,st:l,els:p}}},{key:"calculable",value:function(e){var t=Date.now()-e;if(t>5e3)return!0;var n=this.snapshots;return n.length>0&&t-n[n.length-1].t>1e3}},{key:"calculateAreaPercent",value:function(e){var t=e.getBoundingClientRect(),n=t.left,r=t.right,i=t.top,o=t.bottom,a=t.width,s=t.height,c=d,u=h,f=r-n+(c-0)-(Math.max(r,c)-Math.min(n,0));if(f<=0)return 0;var l=o-i+(u-0)-(Math.max(o,u)-Math.min(i,0));return l<=0?0:f*l/(a*s)}},{key:"destroy",value:function(){this.destroyed=!0,this.observer&&this.observer.disconnect();var e=document.body;e&&this.untag(e)}}]),e}();function g(e,t){return window.getComputedStyle?window.getComputedStyle(e)[t]:e.currentStyle[t]}if(window.__PT_GLOBAL_INSTANCE__)p=window.__PT_GLOBAL_INSTANCE__;else{window.__PT_GLOBAL_INSTANCE__=p;var v=p.states;(v.initialState.instance=new p).promise.then((function(e){Object.assign(v.initialState.timing,{fmp:e.fmp}),v.initialState.finished=!0}),(function(e){v.initialState.failed=e}))}t.default=p},Qw7Q:function(e,t,n){"use strict";n.r(t),n.d(t,"resource",(function(){return o}));var r=n("GN+H"),i=n("L8Ib"),o=function(){var e=i.win.performance;if(!e||!Object(r.typeTest)(e,"performance")||!Object(r.typeTest)(e.getEntriesByType,"function"))return null;var t=Object.create(null),n=null,o=e.timing||{},a=e.getEntriesByType("resource")||[];return t.begin=o[i.timingKeys[1]]||Date.now(),"function"==typeof i.win.PerformanceNavigationTiming&&(n=e.getEntriesByType("navigation")[0])&&(o=n),Object(r.each)({dom:[10,8],load:[14,1]},(function(e,n){var r=o[i.timingKeys[e[1]]],a=o[i.timingKeys[e[0]]];if(r>0&&a>0){var s=Math.round(a-r);s>=0&&s<6e5&&(t[n]=s)}})),t.res=Object(r.jsonify)(a),t}},SksO:function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},TCgp:function(e,t,n){"use strict";n.r(t),n.d(t,"Browser",(function(){return T}));var r=n("cDf5"),i=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),u=n("PJYZ"),f=n.n(u),d=n("7W2i"),h=n.n(d),l=n("a1gu"),p=n.n(l),g=n("Nsbk"),v=n.n(g),m=n("lSNA"),y=n.n(m),b=n("L8Ib"),w=n("LjfM"),O=n("Qw7Q"),j=n("M3MN"),k=n("r2WV"),_=n("GN+H"),S=n("Jqko");function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var T=function(e){h()(n,e);var t=E(n);function n(e){var r;return a()(this,n),r=t.call(this,e),y()(f()(r),"_isRobot",void 0),y()(f()(r),"hasReady",void 0),y()(f()(r),"prevPage",void 0),y()(f()(r),"_lastUnload",0),y()(f()(r),"behaviorQueue",[]),y()(f()(r),"hasInitBehavior",!1),y()(f()(r),"href",b.win.location&&b.win.location.href),y()(f()(r),"lastEvent",null),y()(f()(r),"clickTimer",null),y()(f()(r),"keypressTimer",null),y()(f()(r),"hashChangeHandler",null),y()(f()(r),"stateChangeHandler",null),y()(f()(r),"hasHackedHistoryState",void 0),y()(f()(r),"hasInitHandler",void 0),y()(f()(r),"hasInitHook",!1),e&&e.serviceCode?r.href&&r.href.startsWith("file:///")?(Object(_.warn)("HandsLogger not work on local file"),p()(r)):(r._conf=Object.assign({},{uid:null,type:"web",setUsername:null,urlHelper:[{rule:/(help\/new)#(\w|\/){0,}/g,target:"$1"},{rule:/\/(share\/)(\w|=){2,}/g,target:"/$1**"}],apiHelper:{rule:/(\w+)\/\d{2,}/g,target:"$1"},environment:"prod",ignore:{ignoreUrls:[/hot-upload/],ignoreApis:[],ignoreErrors:[/^Script error\.?$/]},sample:1,ignoreUrlCase:!1,reportUrl:"",debug:!1,disableHook:!1,autoSendPerf:!0,enableSPA:!0,useFmp:!0,enableLinkTrace:!0,sendResource:!0,behavior:!0,enableConsole:!0,isMicroProject:!1,parseHash:function(e){return(e?Object(_.cutUrlSearch)(e.replace(/^#\/?/,"")):"")||"index"},parseResponse:function(e){if(!e||"object"!=i()(e))return{};var t=e.code,n=e.msg||e.message||e.subMsg||e.errorMsg||e.ret||e.errorResponse||"";return"object"==i()(n)&&(t=t||n.code,n=n.msg||n.message||n.info||n.ret||Object(_.jsonify)(n)),{msg:n,code:t,success:!0}}},r._conf),r._debug("Browser::constructor::finallyConfig",r._conf),r._isRobot=Object(_.isRobot)(),r._isRobot||(r.initHandler(),r.initHook(),r.getPerformance(),r._conf&&r._conf.behavior&&"function"==typeof r.initBehavior&&r.initBehavior(),Object(_.on)(b.win,"error",(function(e){r.errorHandler(e)}),!1,!0),Object(_.on)(b.win,"unhandledrejection",(function(e){r.errorHandler(e)}))),r):(Object(_.warn)("serviceCode is required to instantiate HandsLogger"),p()(r))}return c()(n,[{key:"getPerformance",value:function(e){var t=this;e||Object(S.getAll)(this._conf.enableSPA).then((function(e){var n={firstPaint:e&&e.fpt||0,completeLoad:e&&e.load||0,domReady:e&&e.ready||0};t.getConfig("useFmp")&&(n.fmp=e&&e.fmp||0),t._debug("Browser::getPerformance::more",n),t.sendPerformance(n)})).catch((function(e){t._debug("Browser::getPerformance::error",e)}))}},{key:"onReady",value:function(e){var t=this;return this._debug("Browser::onReady"),this._isRobot?this:this.hasReady?e():void("complete"===b.win.document.readyState?(this.hasReady=!0,e()):Object(_.on)(b.win,"load",(function(){t.hasReady=!0,e()}),!0))}},{key:"getPage",value:function(e){var t=this._conf,n=t.page,r=location.href,i=n&&!e?Object(_.safetyCall)(n,[],n+""):Object(_.filterByRule)(t.ignoreUrlCase?r.toLowerCase():r,t.urlHelper);t.getPage&&"function"==typeof t.getPage?i=t.getPage():(i.indexOf(";")>0&&(i=i.split(";")[0]),this.getConfig("enableSPA")?t.parseHash&&"function"==typeof t.parseHash&&(i="/"+t.parseHash(location.hash)):i.indexOf("#")&&(i=i.split("#")[0]),i=Object(_.removeUrlSearch)(i));if(t.isMicroProject){var o=r.split("/").indexOf("#");o>0&&(i=r.split("/")[o-1]+"/#"+i)}return this._debug("Browser::getPage::result",i),i}},{key:"setPage",value:function(e,t){if(this._debug("Browser::setPage",e,this.prevPage,t),!1!==t){if(!e||e===this.prevPage)return this;this.prevPage=e,this.handleUnload(),this.resetPageview(),this.hasSendPerf=!1,this._conf.page=e,this.getPerformance(t)}else this.prevPage=e;return this}},{key:"setConfig",value:function(e){return this._debug("Browser::setConfig",e),e&&"object"===i()(e)?(e=Object(_.verifyConfig)(e),"hands_user_config"in(e=this.setReportUrl(e))&&"object"===i()(e.hands_user_config)&&(e=Object.assign({},e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.hands_user_config))),e=Object.assign({},this._conf,e)):this._conf}},{key:"sendRequest",value:function(e,t){var n=this.getMetaInfo(),r=e.length+(n.uid?n.uid:"")+(n.page?n.page:"")+n.app+n.tid,i=n.tid.split("#")[2];return n.sign=Object(_.go)(r,i),this._debug("Browser::sendRequest::meta",n),Object(j.sender)(e,this.getConfig("reportUrl"),n,t).catch((function(e){return Object(_.warn)("上报信息有误",e)}))}},{key:"initBehavior",value:function(){if(this._debug("Browser::initBehavior"),!this.hasInitBehavior){try{if(document&&document.referrer&&document.location){var e=document.referrer,t=document.location.href;""!==e&&this.addNavigationBehavior(e,t)}b.win&&b.win.document&&b.win.document.addEventListener&&(b.win.document.addEventListener("click",this.eventHandler("click"),!1),b.win.document.addEventListener("keypress",this.eventHandler("keypress"),!1)),this.getStateInfo(),this.getConfig("enableConsole")&&this.getConsoleInfo()}catch(e){Object(_.warn)("初始化行为监控出错",e)}this.hasInitBehavior=!0}return this}},{key:"addBehavior",value:function(e,t){if(!t&&this._debug("Browser::addBehavior",e),this.getConfig("behavior")&&e&&"object"==i()(e)){var n={},r=e.data||{};if(e.type)n=r;else{if("string"!=typeof r.name||"string"!=typeof r.message)return;n.name=r.name.substr(0,20),n.message=r.message.substr(0,200)}n.message&&(n.message=Object(_.encode)(n.message)),this.behaviorQueue.push({type:e.type||"custom",data:n||{},timestamp:e.timestamp||Date.now(),page:e.page||b.win&&b.win.location&&b.win.location.pathname}),this.behaviorQueue=this.behaviorQueue.slice(-20)}}},{key:"eventHandler",value:function(e,t){this._debug("Browser::eventHandler",e,t);var n=this;return function(r){if(r&&r!==n.lastEvent){var i;n.lastEvent=r;try{i=r.target}catch(e){i="<unknown>"}if(0!==i.length){var o={type:"ui.".concat(e),data:{message:n.getEventMsg(i)},timestamp:Date.now()};"click"===e?(n.clickTimer&&clearTimeout(n.clickTimer),t?n.clickTimer=setTimeout((function(){n&&n.addBehavior(o)}),0):n&&n.addBehavior(o)):"keypress"===e&&(n.keypressTimer||n&&n.addBehavior(o),clearTimeout(n.keypressTimer),n.keypressTimer=setTimeout((function(){n.keypressTimer=void 0}),100))}}}}},{key:"getXpath",value:function(e){var t=[];if(!e||!e.tagName||"string"!=typeof e.tagName)return"";t.push(e.tagName.toLowerCase()),e.id&&"string"==typeof e.id&&t.push("#".concat(e.id));var n=e.className;return n&&"string"==typeof n&&n.split(/\s+/).forEach((function(e){return t.push(".".concat(e))})),b.htmlAttributes.forEach((function(n){var r=e.getAttribute(n);"string"==typeof r&&t.push("[".concat(n,'="').concat(r,'"]'))})),t.join("")}},{key:"getEventMsg",value:function(e){if(this._debug("Browser::getEventMsg",e),!e||1!==e.nodeType)return"";for(var t=e||null,n=[],r=0,i=0,o=" > ".length,a="";t&&r++<5&&!("html"===(a=this.getXpath(t))||r>1&&i+n.length*o+a.length>=80);)n.push(a),i+=a.length,t=t.parentNode;return n.reverse().join(" > ")}},{key:"needsHackState",value:function(){var e=b.win&&b.win.chrome,t=e&&e.app&&e.app.runtime,n="history"in b.win&&!!b.win.history.pushState&&!!b.win.history.replaceState;return!t&&n}},{key:"getStateInfo",value:function(){if(this._debug("Browser::stateHandler"),this.needsHackState()){var e=b.win.onpopstate,t=this;b.win.onpopstate=function(){t.addNavigationBehavior(t.href,b.win.location.href);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(e)return e.apply(this,r)};var n=function(e){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=r.length>2?r[2]:void 0;return o&&t.addNavigationBehavior(t.href,String(o)),e.apply(this,r)}};Object(_.reWriteMethod)(b.win.history,"pushState",n),Object(_.reWriteMethod)(b.win.history,"replaceState",n)}}},{key:"addNavigationBehavior",value:function(e,t){this._debug("Browser::addNavigationBehavior",e,t),this.addBehavior({type:"navigation",data:{from:e,to:t}}),this.href=t}},{key:"getConsoleInfo",value:function(){var e=this;this._debug("Browser::getConsoleInfo"),b.win&&b.win.console&&function(){for(var t=b.consoleMethods,n=e,r=function(e){var r=t[e];b.win.console[r]&&"function"==typeof b.win.console[r]&&Object(_.reWriteMethod)(b.win.console,r,(function(e){var t=r;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];if(b.ignoreConsole.test(i.toString())||n&&n.addBehavior&&n.addBehavior({type:"console",data:{level:t,message:i&&i.toString().substring(0,1e3)}},!0),"error"===t)for(var a=0;a<i.length;a++){var s=i[a];s&&s.message&&s.stack&&n&&n.errorHandler&&n.errorHandler(new ErrorEvent("error",{error:s,message:s.message&&s.message.substring(0,1e3)}),!0)}e&&Function.prototype.apply.call(e,b.win.console,i)}}))},i=0;i<t.length;i++)r(i)}()}},{key:"errorHandler",value:function(e,t){if(!t&&this._debug("Browser::errorHandler",e),!e)return this;var n=e.type;if("error"===n){var r=e.target;!r||!r.tagName||e.message||e.filename||e.lineno||e.colno?this.getConfig("behavior")?(this.error(e.error||{message:e.message},this.behaviorQueue,e),this.behaviorQueue=[]):this.error(e.error||{message:e.message},[],e):this.resourceErrorHandler(e)}else"unhandledrejection"===n&&Object(_.typeTest)(e.reason,"Error")&&Object(_.checkAutoError)(e.reason)&&(this.getConfig("behavior")?(this.error(e.reason,this.behaviorQueue),this.behaviorQueue=[]):this.error(e.reason,[]));return this}},{key:"resourceErrorHandler",value:function(e){this._debug("Browser::resourceErrorHandler",e);var t=e.target;try{var n=t.src||t.href||t.outerHTML||t.innerHTML,r=t.tagName?t.tagName.toLowerCase():"",i=this.getResXPath(t);/J_lazyload/.test(i)||this.error("ResourceError",[],{src:n&&n.substring(0,1e3),node_name:r,xpath:i})}catch(e){Object(_.warn)("资源错误处理出错",e)}return this}},{key:"getResXPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;this._debug("Browser::getResXPath");var n=(e.tagName?e.tagName.toLowerCase():"")+(e.id?"#"+e.id:"")+(e.className?"."+e.className.split(" ").join("."):"");return e.parentNode&&e.parentNode.tagName&&t-1!=0?this.getResXPath(e.parentNode,t-1)+" > "+n:n}},{key:"sendPerformance",value:function(e){this._debug("Browser::sendPerformance",e);var t=this;t.onReady((function(){var n=Object(w.performance)(),r={};t.getConfig("sendResource")&&(r=Object(O.resource)())&&r.load&&r.load>0&&(r.load<=2e3||r.load<=8e3&&Math.random()>.05||(r.page=t.getPage(),r.dl=location&&location.href)),b.win&&b.win.yanxaun_apm_webview_trace_id&&(n.mobile_traceId=b.win.yanxaun_apm_webview_trace_id||""),n&&n.completeLoad&&n.completeLoad>0&&(e&&(n=Object.assign({},n,e)),t.performance(n,r))}))}},{key:"handleUnload",value:function(){this._debug("Browser::handleUnload",this.reportQueue),this._debug("Browser::handleUnload::isSendPerf",this.hasSendPerf);var e=Date.now();return this._debug("Browser::handleUnload::throttle",e-this._lastUnload),e-this._lastUnload<200||(this._lastUnload=e,this.hasSendPerf||this.sendPerformance(),this.reportQueue&&this.reportQueue.length>0&&this.consuming(this.reportQueue),this.errorQueue&&this.errorQueue.length>0&&this.consuming(this.errorQueue,!0),this.selfQueue&&this.selfQueue.length>0&&this.clearSelf()),this}},{key:"bindHashChange",value:function(e){this._debug("Browser::bindHashChange",e);var t=this;if(!(!e^t.hashChangeHandler))if(e){t.hackHistoryState();var n=t&&t._conf&&"function"==typeof t._conf.parseHash;t.hashChangeHandler=function(e){var n=t._conf.parseHash(location.hash);n&&t.setPage(n,!1!==e)},t.stateChangeHandler=function(e){var n=t._conf.parseHash(e.detail);n&&t.setPage(n)},n&&(Object(_.on)(b.win,"hashchange",t.hashChangeHandler),Object(_.on)(b.win,"historystatechange",t.stateChangeHandler),t.hashChangeHandler(!1))}else Object(_.off)(b.win,"hashchange",t.hashChangeHandler),Object(_.off)(b.win,"historystatechange",t.stateChangeHandler),t.hashChangeHandler=null,t.stateChangeHandler=null}},{key:"initHandler",value:function(){this._debug("Browser::initHandler");var e=this;return e.hasInitHandler||(Object(_.on)(b.win,"beforeunload",(function(){e.handleUnload()})),this.bindHashChange(e._conf&&e._conf.enableSPA),this.hasInitHandler=!0),e}},{key:"hackHistoryState",value:function(){return this.hasHackedHistoryState||(this.hackState("pushState"),this.hackState("replaceState"),this.hasHackedHistoryState=!0,this._debug("Browser::hackHistoryState::success")),this}},{key:"hackState",value:function(e){if(this._debug("Browser::hackState",e),!b.win["__".concat(e,"_is_hacked")]){var t=function(e,t){var n;b.win.CustomEvent?n=new CustomEvent(e,{detail:t}):((n=b.win&&b.win.document&&b.win.document.createEvent("HTMLEvents")).initEvent(e,!1,!0),n.detail=t),b.win.dispatchEvent(n)},n=b.win.history||{},r=n[e];"function"==typeof r&&(n[e]=function(i,o,a){var s=location&&location.href||"",c=r.apply(n,[i,o,a]);if(!a||"string"!=typeof a)return c;if(a===s)return c;try{var u=s.split("#"),f=a.split("#"),d=Object(_.cutUrlSearch)(u[0]),h=Object(_.cutUrlSearch)(f[1]),l=u[1]&&u[1].replace(/^\/?(.*)/,"$1"),p=f[0]&&f[0].replace(/^\/?(.*)/,"$1");d!==h?t("historystatechange",h):l!==p&&t("historystatechange",p)}catch(t){Object(_.warn)("Hack ".concat(e,"出错 : ").concat(t))}return c},n[e].toString=Object(_.createFakeToString)(e),b.win["__".concat(e,"_is_hacked")]=!0)}}},{key:"reportApi",value:function(e,t,n,r,i,o,a,s,c){this._debug("Browser::reportApi::sid",c);var u=Object(_.jsonParse)(r)||null,f=Object(_.safetyCall)(e,[u,n],null);if(!f)return!1;var d=f.code||i,h=!("success"in f)||f.success;return this.api(t,h,o,d,f.msg,a,"{}",s,c),!0}},{key:"removeHook",value:function(){return this._debug("Browser::removeHook"),Reflect.has(b.win,b.fetchMark)&&(b.win[b.fetchMethod]=b.win[b.fetchMark],Reflect.deleteProperty(b.win,b.fetchMark)),Reflect.has(b.win,b.xhrMark)&&(b.win[b.xhrMethod]=b.win[b.xhrMark],Reflect.deleteProperty(b.win,b.xhrMark)),this.hasInitHook=!1,this}},{key:"addHook",value:function(){return this.addFetchHook(),this.addXhrHook(),this._debug("Browser::addHook::success"),this}},{key:"addFetchHook",value:function(){if(this._debug("Browser::addFetchHook"),!Reflect.has(b.win,b.fetchMark)&&"function"==typeof b.win[b.fetchMethod]){var e=b.win[b.fetchMethod],t=this;b.win[b.fetchMark]=e,b.win[b.fetchMethod]=function(n,r){t._debug("Browser::addXhrHook::useFetch");var o=e.apply(b.win,[n,r]);if(!t||!t.api)return t._debug("Browser::addFetchHook::!ctx.api",n,r),o;if(r&&("HEAD"===r.method||"no-cors"===r.mode))return t._debug("Browser::addFetchHook::HEAD",r),o;var a=Date.now(),s=t._conf,c=(n&&"string"!=typeof n?n.url:n)||"",u=c;if(c=Object(_.cutUrlSearch)(c),Object(_.ignoreDevInfo)(c,/hot-update|sockjs-node/))return t._debug("Browser::addFetchHook::ignored DevInfo",c),o;if(!Object(_.checkAPI)(c,!0))return t._debug("Browser::addFetchHook::ignored URL",c),o;c=Object(_.filterByRule)(c,s.apiHelper);var f="",d="";if(s.enableLinkTrace){var h=Object(_.getCurrentOrigin)();if(Object(_.checkSameOrigin)(u,h)){if(n&&"string"!=typeof n)try{if(n.headers&&"function"==typeof n.headers.get&&"function"==typeof n.headers.append){var l=n.headers.get(b.HandsHeaders.traceId),p=n.headers.get(b.HandsHeaders.spanId);l?f=l:(f=t.getTraceId(),n.headers.append(b.HandsHeaders.traceId,f)),p?d=p:(d=t.getSpanId(),n.headers.append(b.HandsHeaders.spanId,d))}}catch(e){Object(_.warn)("为Fetch方法添加头部失败",e)}r&&(r.headers=r.headers?r.headers:{},r.headers[b.HandsHeaders.traceId]?f=r[b.HandsHeaders.traceId]:(f=t.getTraceId(),r.headers[b.HandsHeaders.traceId]=f),r.headers[b.HandsHeaders.spanId]?d=r[b.HandsHeaders.spanId]:(d=t.getSpanId(),r.headers[b.HandsHeaders.spanId]=d))}else t._debug("Browser::addFetchHook::not SameOrigin")}return o.then((function(e){if(!t||!t.api)return e;try{if(!e||"function"!=typeof e.clone)return e;var o=e.clone(),f=o.headers;if(f&&"function"==typeof f.get){var d=f.get("content-type");if(d&&!/(text)|(json)/.test(d))return e}var h=Date.now()-a,l=+o.status;t._debug("Browser::addFetchHook::status",l);var p=!1,g="";return 401===l||403===l?(t._debug("Browser::addFetchHook::status:401 or 403"),p=!0):(n&&"string"!=typeof n&&n.headers&&"function"==typeof n.headers.get&&(p=n.headers.has(b.HandsHeaders.pending),g=n.headers.get(b.HandsHeaders.spanId)),r&&(r.headers=r.headers?r.headers:{},p=!!r.headers[b.HandsHeaders.pending],g=r.headers[b.HandsHeaders.spanId])),t._debug("Browser::addFetchHook::isPending",p),t._debug("Browser::addFetchHook::spanId",g),p?o.text().then((function(e){var d="GET";if(r&&r.method||!n||"object"!==i()(n)?r&&(d=r.method):d=n.method,o.ok)t.reportApi(s.parseResponse,c,u,e,o.status||200,h,a,d,g);else{var l=Object(_.getFetchSnapshot)([n,r],e,f);t.api(c,!1,h,o.status||404,o.statusText,a,l,d,g)}})).then((function(){return e})).catch((function(){return e})):(o.text().then((function(e){var d="GET";if(r&&r.method?d=r.method:n&&"object"===i()(n)&&(d=n.method),o.ok)t.reportApi(s.parseResponse,c,u,e,o.status||200,h,a,d,g);else{var l=Object(_.getFetchSnapshot)([n,r],e,f);t.api(c,!1,h,o.status||404,o.statusText,a,l,d,g)}})),e)}catch(t){return Object(_.warn)("解析Fetch结果失败",t),e}})).catch((function(e){if(!t||!t.api)throw e;var o="";n&&"string"!=typeof n&&n.headers&&"function"==typeof n.headers.get&&(o=n.headers.get(b.HandsHeaders.spanId)),r&&(r.headers=r.headers?r.headers:{},o=r.headers[b.HandsHeaders.spanId]);var s=Date.now()-a,u=r&&r.method||n&&"object"===i()(n)&&n.method;throw t.api(c,!1,s,500,e.name||e.message||"Request Error",a,"{}",u,o),e}))},b.win[b.fetchMethod].toString=Object(_.createFakeToString)(b.fetchMethod)}}},{key:"addXhrHook",value:function(){if(this._debug("Browser::addXhrHook"),!Reflect.has(b.win,b.xhrMark)&&"function"==typeof b.win[b.xhrMethod]){var e=this,t=e._conf,n=e.getConfig("enableLinkTrace"),r=b.win[b.xhrMethod];b.win[b.xhrMark]=r;var i=0,o=r.prototype.open,a=r.prototype.send,s=r.prototype.setRequestHeader;r.prototype.open=function(r,i){if(e._debug("Browser::addXhrHook::useXHR"),e&&e.api&&this.addEventListener){this.method=r;for(var a=arguments.length,c=new Array(a>2?a-2:0),u=2;u<a;u++)c[u-2]=arguments[u];if(o.call.apply(o,[this,r,i].concat(c)),this.tUrl=i||"",this.oUrl=Object(_.cutUrlSearch)(this.tUrl),Object(_.ignoreDevInfo)(i,/hot-update/))e._debug("Browser::addXhrHook::ignored DevInfo",this.oUrl);else if(Object(_.checkAPI)(this.oUrl,!0)){if(this.oUrl=this.oUrl?Object(_.filterByRule)(this.oUrl,t.apiHelper):"",n){var f=Object(_.getCurrentOrigin)();try{Object(_.checkSameOrigin)(this.tUrl,f)&&s&&"function"==typeof s&&(this.traceId=e.getTraceId(),s.call(this,b.HandsHeaders.traceId,this.traceId),this.spanId=e.getSpanId(),e._debug("Browser::addXhrHook::add_spanId",this.spanId),s.call(this,b.HandsHeaders.spanId,this.spanId))}catch(e){Object(_.warn)("设置XHR头部信息出错误",e)}}}else e._debug("Browser::addXhrHook::ignored URL",this.oUrl)}},r.prototype.send=function(){i=Date.now();var n=null,r=function(){if(this.oUrl&&4===this.readyState){e._debug("Browser::addXhrHook::xhr_spanId",this.spanId);var r=Date.now()-i;if(this.status>=200&&this.status<=299){var o=this.status||200;if("function"==typeof this.getResponseHeader){var a=this.getResponseHeader("Content-Type");if(a&&!/(text)|(json)/.test(a))return;this.responseType&&"text"!==this.responseType?e.api(this.oUrl,!0,r,o,"",i,"{}",this.method,this.spanId):e.reportApi(t.parseResponse,this.oUrl,this.tUrl,this.responseText,o,r,i,this.method,this.spanId)}}else{var s=Object(_.getXhrSnapshot)(this.tUrl,this.method,this);e.api(this.oUrl,!1,r,this.status||500,this.statusText||"XHR FAILED",i,s,this.method,this.spanId)}}n&&Object(_.safetyCall)(n,[],null)};this.addEventListener?this.addEventListener("readystatechange",r,!1):(n=this.onreadystatechange,this.onreadystatechange=r);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];a.call.apply(a,[this].concat(s))}}}},{key:"initHook",value:function(){return this._debug("Browser::initHook"),this.hasInitHook||this.getConfig("disableHook")?(this.removeHook(),this.hasInitHook=!1):(this.addHook(),this.hasInitHook=!0),this}}],[{key:"singleton",value:function(e,t){Object(_.warn)("need overwrite",e,t)}},{key:"createExtraInstance",value:function(e){Object(_.warn)("need overwrite",e)}}]),n}(k.Reporter)},W8MJ:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},a1gu:function(e,t,n){var r=n("cDf5"),i=n("PJYZ");e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},cDf5:function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},dI0T:function(e,t){function n(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function r(e,t,r,i,o,a){return n((s=n(n(t,e),n(i,a)))<<(c=o)|s>>>32-c,r);var s,c}function i(e,t,n,i,o,a,s){return r(t&n|~t&i,e,t,o,a,s)}function o(e,t,n,i,o,a,s){return r(t&i|n&~i,e,t,o,a,s)}function a(e,t,n,i,o,a,s){return r(t^n^i,e,t,o,a,s)}function s(e,t,n,i,o,a,s){return r(n^(t|~i),e,t,o,a,s)}function c(e,t){var r,c,u,f,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,l=-271733879,p=-1732584194,g=271733878;for(r=0;r<e.length;r+=16)c=h,u=l,f=p,d=g,h=i(h,l,p,g,e[r],7,-680876936),g=i(g,h,l,p,e[r+1],12,-389564586),p=i(p,g,h,l,e[r+2],17,606105819),l=i(l,p,g,h,e[r+3],22,-1044525330),h=i(h,l,p,g,e[r+4],7,-176418897),g=i(g,h,l,p,e[r+5],12,1200080426),p=i(p,g,h,l,e[r+6],17,-1473231341),l=i(l,p,g,h,e[r+7],22,-45705983),h=i(h,l,p,g,e[r+8],7,1770035416),g=i(g,h,l,p,e[r+9],12,-1958414417),p=i(p,g,h,l,e[r+10],17,-42063),l=i(l,p,g,h,e[r+11],22,-1990404162),h=i(h,l,p,g,e[r+12],7,1804603682),g=i(g,h,l,p,e[r+13],12,-40341101),p=i(p,g,h,l,e[r+14],17,-1502002290),h=o(h,l=i(l,p,g,h,e[r+15],22,1236535329),p,g,e[r+1],5,-165796510),g=o(g,h,l,p,e[r+6],9,-1069501632),p=o(p,g,h,l,e[r+11],14,643717713),l=o(l,p,g,h,e[r],20,-373897302),h=o(h,l,p,g,e[r+5],5,-701558691),g=o(g,h,l,p,e[r+10],9,38016083),p=o(p,g,h,l,e[r+15],14,-660478335),l=o(l,p,g,h,e[r+4],20,-405537848),h=o(h,l,p,g,e[r+9],5,568446438),g=o(g,h,l,p,e[r+14],9,-1019803690),p=o(p,g,h,l,e[r+3],14,-187363961),l=o(l,p,g,h,e[r+8],20,1163531501),h=o(h,l,p,g,e[r+13],5,-1444681467),g=o(g,h,l,p,e[r+2],9,-51403784),p=o(p,g,h,l,e[r+7],14,1735328473),h=a(h,l=o(l,p,g,h,e[r+12],20,-1926607734),p,g,e[r+5],4,-378558),g=a(g,h,l,p,e[r+8],11,-2022574463),p=a(p,g,h,l,e[r+11],16,1839030562),l=a(l,p,g,h,e[r+14],23,-35309556),h=a(h,l,p,g,e[r+1],4,-1530992060),g=a(g,h,l,p,e[r+4],11,1272893353),p=a(p,g,h,l,e[r+7],16,-155497632),l=a(l,p,g,h,e[r+10],23,-1094730640),h=a(h,l,p,g,e[r+13],4,681279174),g=a(g,h,l,p,e[r],11,-358537222),p=a(p,g,h,l,e[r+3],16,-722521979),l=a(l,p,g,h,e[r+6],23,76029189),h=a(h,l,p,g,e[r+9],4,-640364487),g=a(g,h,l,p,e[r+12],11,-421815835),p=a(p,g,h,l,e[r+15],16,530742520),h=s(h,l=a(l,p,g,h,e[r+2],23,-995338651),p,g,e[r],6,-198630844),g=s(g,h,l,p,e[r+7],10,1126891415),p=s(p,g,h,l,e[r+14],15,-1416354905),l=s(l,p,g,h,e[r+5],21,-57434055),h=s(h,l,p,g,e[r+12],6,1700485571),g=s(g,h,l,p,e[r+3],10,-1894986606),p=s(p,g,h,l,e[r+10],15,-1051523),l=s(l,p,g,h,e[r+1],21,-2054922799),h=s(h,l,p,g,e[r+8],6,1873313359),g=s(g,h,l,p,e[r+15],10,-30611744),p=s(p,g,h,l,e[r+6],15,-1560198380),l=s(l,p,g,h,e[r+13],21,1309151649),h=s(h,l,p,g,e[r+4],6,-145523070),g=s(g,h,l,p,e[r+11],10,-1120210379),p=s(p,g,h,l,e[r+2],15,718787259),l=s(l,p,g,h,e[r+9],21,-343485551),h=n(h,c),l=n(l,u),p=n(p,f),g=n(g,d);return[h,l,p,g]}function u(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function f(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var r=8*e.length;for(t=0;t<r;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function d(e){var t,n,r="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),r+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return r}function h(e){return unescape(encodeURIComponent(e))}function l(e){return function(e){return u(c(f(e),8*e.length))}(h(e))}function p(e,t){return function(e,t){var n,r,i=f(e),o=[],a=[];for(o[15]=a[15]=void 0,i.length>16&&(i=c(i,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],a[n]=1549556828^i[n];return r=c(o.concat(f(t)),512+8*t.length),u(c(a.concat(r),640))}(h(e),h(t))}e.exports=function(e,t,n){return t?n?p(t,e):d(p(t,e)):n?l(e):d(l(e))}},lSNA:function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},lwsE:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},r2WV:function(e,t,n){"use strict";n.r(t),n.d(t,"Reporter",(function(){return _}));var r=n("cDf5"),i=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),c=n.n(s),u=n("PJYZ"),f=n.n(u),d=n("7W2i"),h=n.n(d),l=n("a1gu"),p=n.n(l),g=n("Nsbk"),v=n.n(g),m=n("lSNA"),y=n.n(m),b=n("/7sA"),w=n("L8Ib"),O=n("GN+H");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var _=function(e){h()(n,e);var t=k(n);function n(e){var r;return a()(this,n),r=t.call(this,e),y()(f()(r),"hasSendPerf",!1),y()(f()(r),"perfData",void 0),r}return c()(n,[{key:"error",value:function(e,t,n){if(this._debug("Reporter::error",e,t),!e)return Object(O.warn)("参数错误, 第一个参数必传， err:",e),this;if(0===this.getConfig("sample"))return this;n&&0!==n.length?("string"==typeof e&&(e={message:e}),"object"!==i()(n)&&(n={})):("string"==typeof e&&(e={message:e},n={}),"object"===i()(e)&&(n=e=e.error||e));var r=e.name||"CustomError",o=e.msg||e.message||"",a=e.stack||"";if(n=n||{},Object(O.checkSDKError)(o,n.filename))return Object(O.ignoreByRule)(o,w.scriptErrorReg)||Object(O.ignoreByRule)(Object(O.decode)(o),w.scriptErrorReg)?this:this.self("error",{msg:w.selfErrKey,err:{msg_raw:Object(O.encode)(o)}},1);var s="object"===i()(e)&&Reflect.getPrototypeOf(e).name||"Error",c={begin:Date.now(),name:r,type:s,message:o&&o.substring(0,1e3),stack:a&&a.substring(0,1e3),code:a&&a.substring(0,1e3)||Object(O.jsonify)(n),full:Object(O.encode)(o)},u={action:"corona_web",msg:c.message,json:{ts:c.begin,event:{from:this._conf.type,env:this._conf.environment,SDKversion:this.ver,project:this._conf.serviceCode,url:this.getPage(),referer:w.win&&w.win.document&&w.win.document.referrer,ua:w.ua,breadcrumbs:t||[]},content:c,level:""}},f=(this.getConfig("ignore")||{}).ignoreErrors;return Object(O.ignoreByRule)(c.message,f)||Object(O.ignoreByRule)(Object(O.decode)(c.message),f)?this:this.pushToErrorQueue(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({spn:"error",times:1},u))}},{key:"api",value:function(e,t,n,r,i,o,a,s,c){if(!e)return Object(O.warn)("参数错误，api不能为空"),this;var u=this.getConfig("sample");if(0===u)return this;var f={st:(e="string"==typeof e?{api:e,success:t,time:n,code:r,msg:i,begin:o,method:s,sid:c}:Object(O.sub)(e,w.validApiKeys)).begin||Date.now(),sid:e.sid,spn:"ajax",type:w.spanTypeMap[this._conf.type],psid:this.pageview,url:e.api,et:+e.time,err:e.success?0:1,fds:{httpCode:e.code||"",method:e.method&&e.method.toUpperCase()||"",msg:e.msg||""}};return e.success||(f.fds.apiSnapshot=a),this._debug("Reporter::api::formatted API",e),!e.api||isNaN(e.time)?(Object(O.warn)("API地址、请求时间异常"),this):(this.report("ajax",f,u),this)}},{key:"performance",value:function(e,t){if(this._debug("Reporter::performance"),e&&"object"===i()(e)){var n=0!==this.getConfig("sample")?1:0;if(0===n)return;var r=this.getConfig("type")||"web",o={st:Date.now(),sid:this.pageview,spn:"pageroot",type:w.envMap[r],psid:-1,err:0,fds:e,tgs:{platform:Object(O.getPlatform)()},et:e.domReady};t&&(o.ants={staticResource:Object(O.jsonify)(t)||""});var a=Object(O.getChannel)();return a&&(o.tgs.channel=a),this.hasSendPerf=!0,this.report("pageroot",o,n)}return this}}]),n}(b.Base)},s34b:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n("Qp8T"),i=window.performance?performance.timing:null,o=r.default.states;function a(e){if(e)return o.create().then((function(e){return Promise.resolve(e.fpt)}));var t=o.currentState;return t.instance?new Promise((function(e,n){t.finished?e(t.timing.fpt):t.failed?n(t.failed):t.instance.promise.then((function(t){e(t.fpt)}),(function(e){n(e)}))})):function e(){return new Promise((function(t,n){if(i||n("Object performance not supported"),i.responseEnd){var r=i.responseEnd-i.fetchStart;o.initialState.timing.fpt=r,t(r)}else setTimeout((function(){t(e())}),500)}))}()}}})}));